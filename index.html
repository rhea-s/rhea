<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Rhea Singh ‚Äî Home Page</title>

  <!-- Preload critical images for faster rendering -->
  <link rel="preload" href="assets/avatar_no-eyes.png" as="image" fetchpriority="high" />
  <link rel="preload" href="assets/avatar_eye-pupil.png" as="image" fetchpriority="high" />
  <link rel="preload" href="assets/sf-background-day.png" as="image" fetchpriority="high" />
  <link rel="preload" href="assets/avatar_base-complete-transparent.png" as="image" />
  <link rel="preload" href="assets/sf-background-night.png" as="image" />
  <link rel="preload" href="assets/nyc-background-day-2.png" as="image" />
  <link rel="preload" href="assets/nyc-background-night-2.png" as="image" />
  <link rel="preload" href="assets/bliss-background.png" as="image" />
  <link rel="preload" href="assets/bliss-background-night.png" as="image" />

  <style>
    /* --- Base reset & layout --- */
    *, *::before, *::after { box-sizing: border-box; }
    html, body {
      height: 100%;
      margin: 0;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
      color: #4a0e3d;
      overflow-x: hidden;
      overflow-y: auto;
      margin: 0;
    }

    .desktop {
      position: relative;
      min-height: 1000px;
      background: linear-gradient(135deg, #fce4ec 0%, #f8bbd0 50%, #f48fb1 100%);
      padding: 40px 20px 60px;
    }

    /* --- Retro Window Component System --- */
    :root {
      --pink-chrome: #e5b4d4;
      --pink-border: #d89fca;
      --pink-light: #f5e6f1;
      --text-dark: #4a0e3d;
      --text-muted: #8b6b83;
      --window-shadow: 0 8px 24px rgba(74, 14, 61, 0.15);
      --retro-sunrise: linear-gradient(135deg, rgba(255, 246, 244, 0.92), rgba(255, 209, 244, 0.9));
      --retro-haze: radial-gradient(circle at 15% 20%, rgba(255, 255, 255, 0.55) 0%, transparent 55%),
        radial-gradient(circle at 85% 15%, rgba(255, 255, 255, 0.45) 0%, transparent 50%),
        linear-gradient(135deg, rgba(250, 217, 239, 0.55), rgba(214, 174, 229, 0.3));
      --retro-chip: linear-gradient(135deg, rgba(255, 255, 255, 0.92), rgba(243, 211, 238, 0.88));
      --retro-card: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(245, 225, 248, 0.92));
      --micro-ease: cubic-bezier(0.22, 0.61, 0.36, 1);

      /* Eye tracking variables */
      --eye-left-x: 42.9%;
      --eye-left-y: 40.6%;
      --eye-right-x: 57.2%;
      --eye-right-y: 40.6%;
      --pupil-size: 16px;
      --pupil-radius: 2.1px;
    }

    .window {
      position: absolute;
      background: rgba(255, 255, 255, 0.95);
      border: 2px hidden var(--pink-border);
      border-radius: 8px;
      box-shadow: var(--window-shadow);
      overflow: hidden;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .window:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 32px rgba(74, 14, 61, 0.2);
    }

    .window-titlebar {
      background: var(--pink-chrome);
      padding: 8px 12px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border-bottom: 1px solid var(--pink-border);
      user-select: none;
    }

    .window-title {
      font-size: 13px;
      font-weight: 600;
      color: var(--text-dark);
      flex: 1;
      text-align: center;
      letter-spacing: 0.3px;
    }

    .window-controls {
      display: flex;
      padding-right: 10px;
      gap: 6px;
    }

    .window-button {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      border: 1px solid rgba(74, 14, 61, 0.2);
      background: var(--pink-light);
      cursor: default;
    }

    .window-button.close { background: #f4a5b9; }
    .window-button.minimize { background: #f5d5e0; }
    .window-button.maximize { background: #f5e6f1; }

    /* Interactive close button for project windows */
    .project-window .window-button.close {
      cursor: pointer;
      transition: background-color 0.2s ease;
    }

    .project-window .window-button.close:hover {
      background: #e8738d;
    }

    .theme-toggle {
      width: 44px;
      height: 22px;
      border-radius: 11px;
      background: rgba(200, 200, 200, 0.75);
      border: none;
      position: relative;
      cursor: pointer;
      transition: background-color 0.3s ease;
      flex-shrink: 0;
    }

    .theme-toggle:hover {
      opacity: 0.8;
    }

    .theme-toggle.active {
      background: rgba(200, 200, 200, 0.75);
    }

    .theme-toggle-knob {
      position: absolute;
      top: 3px;
      left: 3px;
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background: white;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.15);
      transition: transform 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
    }

    .theme-toggle.active .theme-toggle-knob {
      transform: translateX(25px);
    }

    .theme-toggle-icon {
      position: absolute;
      font-size: 12px;
      top: 50%;
      transform: translateY(-50%);
      opacity: 0.5;
      pointer-events: none;
      color: #4a0e3d;
    }

    .theme-toggle-icon.moon {
      left: 6px;
    }

    .theme-toggle-icon.sun {
      right: 6px;
    }

    .window-content {
      padding: 20px;
      overflow-y: auto;
    }

    /* --- FaceTime Window (Avatar) --- */
    .facetime-window {
      width: 360px;
      top: 60px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 10;
      background: #1c1c1e;
    }

    .facetime-window:hover {
      transform: translateX(-50%);
      box-shadow: var(--window-shadow);
    }

    .facetime-content {
      padding: 0;
      width: 100%;
      position: relative;
      background-color: #1c1c1e;
    }

    .avatar-loading {
      position: absolute;
      inset: 0;
      z-index: 3;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 12px;
      background: rgba(12, 12, 16, 0.82);
      color: rgba(255, 255, 255, 0.92);
      font-size: 14px;
      letter-spacing: 0.2px;
      transition: opacity 180ms ease;
    }

    .avatar-loading.is-hidden {
      opacity: 0;
      visibility: hidden;
      pointer-events: none;
    }

    .avatar-spinner {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      border: 3px solid rgba(255, 255, 255, 0.25);
      border-top-color: rgba(255, 255, 255, 0.9);
      animation: avatarSpin 1s linear infinite;
    }

    @keyframes avatarSpin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0;
    }

    .facetime-content::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: var(--bg-image);
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      z-index: 0;
      clip-path: circle(150% at 50% 40%);
    }

    /* Camera iris closing animation */
    .facetime-content.iris-close::before {
      animation: irisClose 0.3s ease-in forwards;
    }

    /* Camera iris opening animation */
    .facetime-content.iris-open::before {
      animation: irisOpen 0.3s ease-out forwards;
    }

    /* FaceTime background fade animations */
    .facetime-content.fade-out::before {
      animation: facetimeFadeOut 0.2s ease-out forwards;
    }

    .facetime-content.fade-in::before {
      animation: facetimeFadeIn 0.2s ease-out forwards;
    }

    @keyframes irisClose {
      from {
        clip-path: circle(150% at 50% 40%);
        filter: brightness(1);
      }
      to {
        clip-path: circle(0% at 50% 40%);
        filter: brightness(0.8);
      }
    }

    @keyframes irisOpen {
      from {
        clip-path: circle(0% at 50% 40%);
        filter: brightness(0.8);
      }
      to {
        clip-path: circle(150% at 50% 40%);
        filter: brightness(1);
      }
    }

    @keyframes facetimeFadeOut {
      from {
        opacity: 1;
      }
      to {
        opacity: 0;
      }
    }

    @keyframes facetimeFadeIn {
      from {
        opacity: 0;
      }
      to {
        opacity: 1;
      }
    }

    .avatar-stage {
      position: relative;
      z-index: 1;
      isolation: isolate;
      aspect-ratio: 8/7;
      display: grid;
      place-items: center;
      overflow: hidden;
      user-select: none;
      -webkit-user-drag: none;
    }

    .avatar {
      position: relative;
      z-index: 2;
      width: 120%;
      height: auto;
      transform: translateY(-40px);
      display: block;
      cursor: pointer;
    }

    .pupil-backdrop {
      position: absolute;
      top: 44%;
      left: 50%;
      width: calc(46% - 40px);
      height: 22%;
      background: #fff;
      transform: translate(-50%, -50%);
      border-radius: 12px;
      z-index: 0;
      pointer-events: none;
    }

    .pupil {
      position: absolute;
      z-index: 1;
      width: var(--pupil-size);
      height: var(--pupil-size);
      border-radius: 50%;
      background-image: url("assets/avatar_eye-pupil.png");
      background-size: cover;
      background-repeat: no-repeat;
      background-position: center;
      transform: translate(-50%, -50%);
      will-change: transform;
      transition: transform 120ms cubic-bezier(.2,.6,.2,1);
    }

    .pupil.left  { left: var(--eye-left-x); top: var(--eye-left-y); }
    .pupil.right { left: var(--eye-right-x); top: var(--eye-right-y); }

    .speech-bubble {
      position: absolute;
      bottom: 38%;
      right: 5%;
      background: white;
      color: var(--text-dark);
      padding: 10px 10px;
      border-radius: 16px;
      border: 2px hidden var(--pink-border);
      box-shadow: 0 4px 12px rgba(74, 14, 61, 0.15);
      font-size: 14px;
      font-weight: 200;
      z-index: 3;
      white-space: nowrap;
      will-change: transform, opacity;
    }

    .speech-bubble--initial {
      animation: bubbleFadeIn 0.6s ease-out;
    }

    .speech-bubble--night {
      background: rgba(32, 27, 44, 0.95);
      color: rgba(255, 255, 255, 0.92);
      border: 1px solid rgba(255, 255, 255, 0.12);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.35);
    }

    @keyframes bubbleFadeIn {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes bubbleSlideOut {
      from {
        opacity: 1;
        transform: translateY(0);
      }
      to {
        opacity: 0;
        transform: translateY(-15px);
      }
    }

    @keyframes bubbleSlideIn {
      from {
        opacity: 0;
        transform: translateY(15px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .speech-bubble--exiting {
      animation: bubbleSlideOut 0.3s ease-out forwards;
    }

    .speech-bubble--entering {
      animation: bubbleSlideIn 0.3s ease-out forwards;
    }

    .avatar-info {
      padding: 16px;
      text-align: center;
      background: white;
      border-top: 1px solid var(--pink-border);
      position: relative;
      z-index: 1;
    }

    .avatar-name {
      font-size: 18px;
      font-weight: 700;
      color: var(--text-dark);
      margin-bottom: 4px;
    }

    .avatar-subtitle {
      font-size: 13px;
      color: var(--text-muted);
    }

    /* --- Location Footer (integrated into FaceTime window) --- */
    .location-footer {
      padding: 10px 16px;
      background: white;
      border-top: 1px solid var(--pink-border);
      text-align: center;
      font-size: 12px;
      font-weight: 500;
      color: var(--text-muted);
      letter-spacing: 0.2px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      position: relative;
      z-index: 1;
    }

    .online-indicator {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: #27c93f;
      box-shadow: 0 0 0 2px rgba(39, 201, 63, 0.2);
      animation: pulse 2s ease-in-out infinite;
    }

    @keyframes pulse {
      0%, 100% {
        box-shadow: 0 0 0 2px rgba(39, 201, 63, 0.2);
      }
      50% {
        box-shadow: 0 0 0 4px rgba(39, 201, 63, 0.1);
      }
    }

    /* --- About/Education Window --- */
    .about-window {
      width: 420px;
      top: 80px;
      left: 80px;
      z-index: 5;
    }

    .section-heading {
      font-size: 14px;
      font-weight: 700;
      color: var(--text-dark);
      margin-bottom: 12px;
      padding-bottom: 6px;
      border-bottom: 2px solid var(--pink-light);
    }

    .info-block {
      margin-bottom: 16px;
    }

    .info-title {
      font-size: 14px;
      font-weight: 600;
      color: var(--text-dark);
      margin-bottom: 4px;
    }

    .info-subtitle {
      font-size: 12px;
      color: var(--text-muted);
      margin-bottom: 4px;
    }

    .info-meta {
      font-size: 11px;
      color: var(--text-muted);
      font-style: italic;
    }

    .info-list {
      margin: 8px 0 0 0;
      padding-left: 18px;
      font-size: 12px;
      line-height: 1.6;
      color: var(--text-dark);
    }

    .info-list li {
      margin-bottom: 4px;
    }

    /* --- Experience Window --- */
    .experience-window {
      width: 480px;
      top: 540px;
      left: 37%;
      transform: translateX(-50%);
      z-index: 7;
      max-height: 400px;
    }

    .experience-window .window-content {
      max-height: 400px;
    }

    .job-item {
      margin-bottom: 20px;
      padding-bottom: 16px;
      border-bottom: 1px solid var(--pink-light);
    }

    .job-item:last-child {
      border-bottom: none;
    }

    .job-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 8px;
      gap: 12px;
    }

    .job-company {
      font-size: 14px;
      font-weight: 700;
      color: var(--text-dark);
    }

    .job-role {
      font-size: 13px;
      color: var(--text-muted);
      margin-bottom: 4px;
    }

    .job-date {
      font-size: 11px;
      color: var(--text-muted);
      white-space: nowrap;
    }

    /* --- Skills Window (System/Finder Style) --- */
    .skills-window {
      width: 270px;
      top: 380px;
      left: 100px;
      z-index: 6;
      background: white;
      border: 1px solid #d0d0d0;
    }

    .skills-window .window-titlebar {
      background: #f5f5f5;
      border-bottom: 1px solid #d0d0d0;
    }

    .skills-window .window-title {
      color: #333;
      font-size: 12px;
      font-weight: 500;
      font-family: 'SF Mono', Consolas, Monaco, 'Courier New', monospace;
    }

    .skills-window .window-content {
      background: white;
      padding: 12px 16px 12px 12px;
    }

    /* File Explorer Styling - macOS Finder inspired */
    .file-explorer {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      padding: 0;
    }

    .folder {
      margin-bottom: 4px;
    }

    .folder:last-child {
      margin-bottom: 0;
    }

    .folder-header {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 4px 8px;
      cursor: pointer;
      border-radius: 6px;
      transition: background-color 0.15s ease;
      user-select: none;
    }

    .folder-header:hover {
      background: rgba(0, 0, 0, 0.05);
    }

    .folder-icon {
      width: 16px;
      height: 16px;
      flex-shrink: 0;
    }

    .folder-name {
      font-size: 13px;
      font-weight: 600;
      color: #333;
      flex: 1;
      letter-spacing: -0.01em;
    }

    .folder-arrow {
      font-size: 10px;
      color: #999;
      transition: transform 0.2s ease;
    }

    .folder.collapsed .folder-arrow {
      transform: rotate(-90deg);
    }

    .folder-content {
      margin-left: 24px;
      margin-top: 2px;
      max-height: 500px;
      overflow: hidden;
      transition: max-height 0.3s ease, opacity 0.3s ease;
    }

    .folder.collapsed .folder-content {
      max-height: 0;
      opacity: 0;
    }

    .file {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 3px 8px;
      font-size: 13px;
      color: #333;
      border-radius: 6px;
      transition: background-color 0.15s ease;
      cursor: default;
    }

    .file:hover {
      background: rgba(0, 0, 0, 0.05);
    }

    .file-icon {
      flex-shrink: 0;
      font-size: 11px;
      color: #d89fca;
      line-height: 1;
    }

    /* --- Extracurriculars Window --- */
    .extra-window {
      width: 380px;
      top: 100px;
      right: 80px;
      z-index: 4;
      max-height: 380px;
    }

    .extra-window .window-content {
      max-height: 380px;
    }

    .experience-window:hover {
      transform: translateX(-50%) translateY(-2px);
    }

    /* --- Dock --- */
    .dock {
      display: flex;
      align-items: flex-end;
      gap: 12px;
      padding: 8px 16px;
      background: rgba(255, 255, 255, 0.25);
      backdrop-filter: blur(20px);
      border: 2px hidden var(--pink-border);
      border-radius: 16px;
      box-shadow: 0 8px 32px rgba(74, 14, 61, 0.2);
    }

    .dock-icon {
      width: 56px;
      height: 56px;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      display: flex;
      align-items: center;
      justify-content: center;
      background: white;
      box-shadow: 0 2px 8px rgba(74, 14, 61, 0.15);
    }

    .dock-icon img {
      width: 100%;
      height: 100%;
      border-radius: 12px;
      object-fit: cover;
    }

    .dock-icon:hover {
      transform: translateY(-8px) scale(1.15);
      box-shadow: 0 12px 24px rgba(74, 14, 61, 0.25);
    }

    .dock-divider {
      width: 1px;
      height: 48px;
      background: var(--pink-border);
      margin: 0 4px;
    }

    /* --- Dock Tooltips --- */
    .dock-tooltip {
      position: absolute;
      bottom: 100%;
      left: 50%;
      transform: translateX(-50%) translateY(-8px);
      background: rgba(40, 44, 52, 0.95);
      color: #abb2bf;
      padding: 6px 12px;
      border-radius: 6px;
      font-size: 12px;
      font-weight: 500;
      white-space: nowrap;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.2s ease, transform 0.2s ease;
      font-family: 'SF Mono', Consolas, Monaco, 'Courier New', monospace;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      z-index: 1001;
    }

    .dock-icon {
      position: relative;
    }

    .dock-icon:hover .dock-tooltip {
      opacity: 1;
      transform: translateX(-50%) translateY(-4px);
    }

    /* --- Terminal Window --- */
    .terminal-window {
      display: none; /* Hidden on desktop, visible on mobile */
      width: 320px;
      top: 520px;
      right: 80px;
      z-index: 8;
      background: rgba(40, 44, 52, 0.95);
      border: 1px solid #21252b;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
      font-family: 'SF Mono', Consolas, Monaco, 'Courier New', monospace;
    }

    .terminal-window .window-titlebar {
      background: #21252b;
      border-bottom: 1px solid #181a1f;
      justify-content: flex-start;
      gap: 12px;
    }

    .terminal-window .window-controls {
      gap: 6px;
      padding-right: 0;
    }

    .terminal-window .window-title {
      color: #abb2bf;
      font-size: 12px;
      font-weight: 500;
      letter-spacing: 0.3px;
      text-align: left;
    }

    .terminal-window .window-content {
      background: transparent;
      padding: 18px;
      color: #abb2bf;
      font-size: 12px;
      line-height: 1.6;
    }

    .terminal-prompt {
      color: #5c6370;
      margin-bottom: 8px;
    }

    .terminal-status {
      display: flex;
      align-items: baseline;
      gap: 8px;
      margin-bottom: 6px;
    }

    .terminal-status:last-child {
      margin-bottom: 0;
    }

    .terminal-bullet {
      color: #98c379;
      flex-shrink: 0;
    }

    .terminal-label {
      color: #abb2bf;
      min-width: 80px;
    }

    .terminal-value {
      color: #98c379;
    }

    .terminal-cursor {
      display: inline-block;
      width: 8px;
      height: 14px;
      background: #98c379;
      margin-left: 2px;
      opacity: 1;
      animation: none; /* No animation by default on desktop */
    }

    /* Cursor blinks when terminal window or dashboard widget is hovered */
    .terminal-window:hover .terminal-cursor,
    .terminal-window.active .terminal-cursor,
    .dashboard-widget:hover .terminal-cursor {
      animation: blink 1s step-end infinite;
    }

    @keyframes blink {
      0%, 50% { opacity: 1; }
      51%, 100% { opacity: 0; }
    }

    /* --- Dashboard Widget (Desktop Terminal) --- */
    .dashboard-widget {
      position: fixed;
      bottom: 100px;
      right: 20px;
      width: 280px;
      background: rgba(40, 44, 52, 0.95);
      backdrop-filter: blur(12px);
      border: 1px solid #21252b;
      border-radius: 8px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
      z-index: 999;
      font-family: 'SF Mono', Consolas, Monaco, 'Courier New', monospace;
      transition:
        width 0.4s cubic-bezier(0.34, 1.56, 0.64, 1),
        height 0.4s cubic-bezier(0.34, 1.56, 0.64, 1),
        border-radius 0.4s cubic-bezier(0.34, 1.56, 0.64, 1),
        bottom 0.4s cubic-bezier(0.34, 1.56, 0.64, 1),
        left 0.4s cubic-bezier(0.34, 1.56, 0.64, 1),
        right 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    .dashboard-titlebar {
      background: #21252b;
      padding: 8px 12px;
      display: flex;
      align-items: center;
      gap: 8px;
      border-bottom: 1px solid #181a1f;
      border-radius: 7px 7px 0 0;
      transition:
        background-color 0.3s ease,
        border 0.3s ease,
        padding 0.3s ease;
    }

    .terminal-dots {
      display: flex;
      gap: 6px;
      align-items: center;
    }

    .terminal-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
    }

    .terminal-dot.red { background: #ff5f56; }
    .terminal-dot.yellow { background: #ffbd2e; }
    .terminal-dot.green { background: #27c93f; }

    .dashboard-title {
      font-size: 12px;
      font-weight: 500;
      color: #abb2bf;
      letter-spacing: 0.3px;
      margin-left: 4px;
      opacity: 1;
      visibility: visible;
      transition:
        opacity 0.25s ease-out,
        visibility 0.25s ease-out,
        max-width 0.25s ease-out;
    }

    .dashboard-content {
      padding: 14px;
      color: #abb2bf;
      font-size: 12px;
      line-height: 1.6;
      opacity: 1;
      visibility: visible;
      transition:
        opacity 0.25s ease-out,
        visibility 0.25s ease-out;
    }

    /* --- Project Windows --- */
    .project-window {
      display: none;
      position: absolute;
      width: 550px;
      top: 22%;
      left: 50%;
      transform: translate(-50%, 0);
      z-index: 900;
      transition: box-shadow 0.2s ease;
    }

    #spellingBeeWindow {
      top: 7%;
      left: 75%;
    }

    #workWindow {
      left: 30%;
      top: 18%;
      width: 500px;
    }

    .apple-project-window {
      left: 70%;
      top: 18%;
      width: 520px;
    }

    .project-window.active {
      display: block;
      z-index: 950;
    }

    .project-window:hover {
      transform: translate(-50%, -2px);
    }

    .project-actions {
      margin: 12px 0 20px;
      display: flex;
      align-items: center;
      justify-content: flex-start;
      gap: 10px;
    }

    .project-launch {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 9px 18px;
      background: linear-gradient(135deg, #f48fb1, #f06292);
      border: 1px solid rgba(74, 14, 61, 0.15);
      border-radius: 999px;
      color: white;
      text-decoration: none;
      font-size: 13px;
      font-weight: 600;
      letter-spacing: 0.3px;
      box-shadow: 0 6px 16px rgba(244, 143, 177, 0.4);
      transition: transform 0.2s ease, box-shadow 0.2s ease, filter 0.2s ease;
    }

    .project-launch:hover {
      transform: translateY(-1px);
      box-shadow: 0 10px 22px rgba(244, 143, 177, 0.45);
      filter: brightness(1.05);
    }

    .project-icon-link {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 38px;
      height: 38px;
      border-radius: 50%;
      border: 1px solid var(--pink-border);
      background: var(--pink-light);
      color: var(--text-dark);
      text-decoration: none;
      transition: transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease;
    }

    .project-icon-link:hover {
      transform: translateY(-1px);
      border-color: rgba(74, 14, 61, 0.25);
      box-shadow: 0 6px 16px rgba(74, 14, 61, 0.2);
    }

    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0;
    }

    .skill-tag {
      display: inline-block;
      padding: 4px 12px;
      background: var(--pink-light);
      border: 1px solid var(--pink-border);
      border-radius: 12px;
      color: var(--text-dark);
      font-size: 12px;
      font-weight: 500;
      margin: 4px 4px 4px 0;
    }

    /* --- Project Grid (Launchpad/Finder Style) --- */
    .apple-projects-empty {
      grid-column: 1 / -1;
      text-align: center;
      font-size: 12px;
      color: var(--text-muted);
      padding: 16px;
      border-radius: 12px;
      background: rgba(255, 255, 255, 0.75);
      border: 1px dashed rgba(74, 14, 61, 0.15);
    }

    .project-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
      gap: 24px;
      padding: 20px;
      justify-items: center;
    }

    .project-grid-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      padding: 12px;
      border-radius: 12px;
      transition: all 0.2s ease;
      user-select: none;
    }

    .project-grid-item:focus-visible {
      outline: 2px solid var(--pink-border);
      transform: scale(1.03);
    }

    .project-grid-item:hover {
      background: rgba(0, 0, 0, 0.03);
      transform: scale(1.05);
    }

    .project-grid-icon {
      width: 64px;
      height: 64px;
      border-radius: 14px;
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(74, 14, 61, 0.15);
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      font-weight: 600;
      letter-spacing: 0.5px;
      background: var(--icon-bg, linear-gradient(135deg, #4b6cb7, #182848));
      color: var(--icon-color, #ffffff);
      text-transform: uppercase;
    }

    .project-grid-item:hover .project-grid-icon {
      box-shadow: 0 4px 16px rgba(74, 14, 61, 0.25);
    }

    .project-grid-icon img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .project-grid-label {
      font-size: 12px;
      font-weight: 500;
      color: var(--text-dark);
      text-align: center;
      line-height: 1.3;
      max-width: 120px;
    }

    /* --- Apple Project Windows --- */
    .apple-project-window {
      max-height: 500px;
    }

    @media (min-width: 1100px) {
      .apple-project-window {
        width: 620px;
      }

      .apple-project-content {
        grid-template-columns: minmax(0, 1fr) minmax(0, 1fr);
      }
    }

    @media (min-width: 1400px) {
      .apple-project-window {
        width: 680px;
      }
    }

    .apple-project-content {
      max-height: 500px;
      overflow-y: auto;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 24px;
      align-content: start;
    }

    .apple-project-section {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .project-hero {
      position: relative;
      padding: 24px;
      border-radius: 22px;
      background: var(--retro-sunrise);
      border: 1px solid rgba(74, 14, 61, 0.12);
      box-shadow: 0 14px 32px rgba(74, 14, 61, 0.18);
      overflow: hidden;
      isolation: isolate;
      transition: transform 220ms var(--micro-ease), box-shadow 220ms var(--micro-ease), filter 220ms ease;
      grid-column: 1 / -1;
    }

    .project-hero::before,
    .project-hero::after {
      content: '';
      position: absolute;
      inset: 0;
      pointer-events: none;
      mix-blend-mode: screen;
      opacity: 0.5;
      transition: opacity 220ms ease;
    }

    .project-hero::before {
      background: var(--retro-haze);
      z-index: 0;
    }

    .project-hero::after {
      background: linear-gradient(160deg, rgba(255, 255, 255, 0.4) 0%, rgba(255, 255, 255, 0) 40%),
        radial-gradient(circle at 30% 80%, rgba(255, 255, 255, 0.32), transparent 60%);
      z-index: 0;
      opacity: 0.35;
    }

    .project-hero:hover {
      transform: translateY(-3px);
      box-shadow: 0 20px 38px rgba(74, 14, 61, 0.22);
    }

    .project-hero:hover::after {
      opacity: 0.55;
    }

    .project-hero > * {
      position: relative;
      z-index: 1;
    }

    .apple-project-hero {
      display: grid;
      gap: 16px;
      align-items: start;
    }

    .apple-project-hero.has-media {
      grid-template-columns: minmax(0, 1fr) 140px;
    }

    .apple-project-hero-body {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .hero-eyebrow {
      font-size: 11px;
      letter-spacing: 1px;
      text-transform: uppercase;
      color: var(--text-muted);
      margin-bottom: 4px;
    }

    .hero-headline {
      font-size: 20px;
      margin: 0 0 4px;
      color: var(--text-dark);
    }

    .hero-subhead {
      font-size: 13px;
      color: var(--text-muted);
      margin: 0 0 12px;
    }

    .hero-summary {
      font-size: 13px;
      line-height: 1.6;
      color: var(--text-dark);
      margin: 0;
    }

    .metric-chip {
      position: relative;
      display: inline-flex;
      flex-direction: column;
      gap: 4px;
      padding: 14px 18px;
      border-radius: 16px;
      background: var(--retro-chip);
      border: 1px solid rgba(74, 14, 61, 0.14);
      box-shadow: 0 10px 24px rgba(74, 14, 61, 0.14);
      max-width: 280px;
      transition: transform 200ms var(--micro-ease), box-shadow 200ms var(--micro-ease);
      overflow: hidden;
    }

    .metric-chip::before {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(120deg, rgba(255, 255, 255, 0.65), rgba(255, 255, 255, 0));
      opacity: 0.75;
      mix-blend-mode: screen;
      transition: opacity 200ms ease;
      pointer-events: none;
    }

    .metric-chip:hover {
      transform: translateY(-2px);
      box-shadow: 0 16px 34px rgba(74, 14, 61, 0.18);
    }

    .metric-chip:hover::before {
      opacity: 1;
    }

    .apple-project-hero-stat {
      display: inline-flex;
      flex-direction: column;
      gap: 4px;
    }

    .apple-project-hero-stat-value {
      font-size: 18px;
      font-weight: 600;
      color: var(--text-dark);
      line-height: 1.2;
    }

    .apple-project-hero-stat-label {
      font-size: 12px;
      color: var(--text-muted);
      line-height: 1.4;
    }

    .apple-project-hero-media {
      width: 128px;
      border-radius: 16px;
      overflow: hidden;
      box-shadow: 0 8px 16px rgba(74, 14, 61, 0.12);
      flex-shrink: 0;
    }

    .apple-project-hero-media img {
      width: 100%;
      height: auto;
      display: block;
    }

    .apple-project-metrics-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 12px;
    }

    .apple-project-metric-card {
      background: rgba(255, 255, 255, 0.8);
      border: 1px solid rgba(74, 14, 61, 0.08);
      border-radius: 12px;
      padding: 12px 14px;
      box-shadow: 0 4px 12px rgba(74, 14, 61, 0.08);
    }

    .apple-project-metric-value {
      font-size: 15px;
      font-weight: 600;
      color: var(--text-dark);
      margin-bottom: 6px;
      display: block;
    }

    .apple-project-metric-label {
      font-size: 12px;
      color: var(--text-muted);
      line-height: 1.4;
      display: block;
    }

    .apple-project-feature-list {
      margin: 0;
    }

    .apple-project-reference-gallery,
    .apple-project-resource-list {
      display: grid;
      gap: 12px;
    }

    .apple-project-resource-list {
      margin-top: 12px;
    }

    .reference-card {
      position: relative;
      border-radius: 18px;
      background: var(--retro-card);
      border: 1px solid rgba(74, 14, 61, 0.1);
      box-shadow: 0 12px 28px rgba(74, 14, 61, 0.14);
      overflow: hidden;
      transition: transform 200ms var(--micro-ease), box-shadow 200ms var(--micro-ease), border-color 200ms ease;
    }

    .reference-card::before {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(100deg, rgba(255, 255, 255, 0.35), rgba(255, 255, 255, 0));
      opacity: 0.8;
      pointer-events: none;
      mix-blend-mode: screen;
      transition: opacity 200ms ease;
    }

    .reference-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 18px 36px rgba(74, 14, 61, 0.22);
      border-color: rgba(74, 14, 61, 0.18);
    }

    .reference-card:hover::before {
      opacity: 1;
    }

    .reference-card__link {
      display: grid;
      grid-template-columns: auto 1fr;
      gap: 16px;
      align-items: start;
      padding: 16px 18px;
      color: inherit;
      text-decoration: none;
      border-radius: 16px;
      position: relative;
      z-index: 1;
    }

    .reference-card__link--no-media {
      grid-template-columns: 1fr;
    }

    .reference-card__link:focus-visible {
      outline: 2px solid rgba(181, 71, 128, 0.8);
      outline-offset: 4px;
    }

    .reference-card__media {
      width: 48px;
      height: 48px;
      border-radius: 12px;
      overflow: hidden;
      background: rgba(74, 14, 61, 0.08);
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }

    .reference-card__media img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    .reference-card__fallback {
      font-size: 18px;
      font-weight: 600;
      color: var(--text-dark);
    }

    .reference-card__body {
      display: grid;
      gap: 6px;
    }

    .reference-card__type {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: var(--text-muted);
    }

    .reference-card__title {
      font-size: 15px;
      font-weight: 600;
      color: var(--text-dark);
      line-height: 1.4;
    }

    .reference-card__excerpt {
      font-size: 13px;
      line-height: 1.6;
      color: var(--text-dark);
      margin: 0;
    }

    .reference-card__excerpt--tweet {
      font-style: normal;
    }

    .reference-card__meta {
      font-size: 12px;
      color: var(--text-muted);
      display: flex;
      gap: 8px;
      align-items: center;
      flex-wrap: wrap;
    }

    .reference-card--tweet {
      background: linear-gradient(135deg, rgba(56, 151, 240, 0.18), rgba(255, 255, 255, 0.95));
      border-color: rgba(56, 151, 240, 0.25);
    }

    .reference-card--tweet .reference-card__type {
      color: rgba(56, 151, 240, 0.9);
    }

    .reference-card--tweet .reference-card__media {
      border-radius: 50%;
      background: rgba(56, 151, 240, 0.18);
    }

    .reference-card__tweet-author {
      display: flex;
      gap: 8px;
      align-items: baseline;
      font-size: 13px;
      color: var(--text-dark);
    }

    .reference-card__tweet-handle {
      color: rgba(56, 151, 240, 0.9);
      font-weight: 500;
      font-size: 12px;
    }

    .reference-card--press .reference-card__media,
    .reference-card--article .reference-card__media,
    .reference-card--news .reference-card__media {
      background: rgba(181, 71, 128, 0.1);
    }

    .reference-card--press .reference-card__type,
    .reference-card--article .reference-card__type,
    .reference-card--news .reference-card__type {
      color: rgba(181, 71, 128, 0.85);
    }

    .project-description {
      font-size: 13px;
      line-height: 1.6;
      color: var(--text-dark);
      margin-bottom: 16px;
    }

    .project-link {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 8px 14px;
      border-radius: 999px;
      background: rgba(255, 255, 255, 0.85);
      border: 1px solid rgba(74, 14, 61, 0.12);
      color: var(--text-dark);
      font-size: 12px;
      font-weight: 600;
      letter-spacing: 0.2px;
      text-decoration: none;
      box-shadow: 0 4px 12px rgba(74, 14, 61, 0.1);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .project-link:hover {
      transform: translateY(-1px);
      box-shadow: 0 8px 20px rgba(74, 14, 61, 0.18);
    }

    @keyframes projectWindowLift {
      0% {
        opacity: 0;
        transform: translateY(12px) scale(0.98);
      }
      100% {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    @keyframes projectChipFloat {
      0% {
        opacity: 0;
        transform: translateY(10px) scale(0.97);
      }
      100% {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    @keyframes referenceShimmer {
      0% {
        opacity: 0;
        transform: translateY(14px);
      }
      60% {
        opacity: 1;
      }
      100% {
        transform: translateY(0);
      }
    }

    .project-window.active .project-hero {
      animation: projectWindowLift 420ms var(--micro-ease);
    }

    .project-window.active .metric-chip {
      animation: projectChipFloat 360ms var(--micro-ease) forwards;
    }

    .project-window.active .apple-project-metric-card:nth-child(1) { animation-delay: 40ms; }
    .project-window.active .apple-project-metric-card:nth-child(2) { animation-delay: 80ms; }
    .project-window.active .apple-project-metric-card:nth-child(3) { animation-delay: 120ms; }
    .project-window.active .apple-project-metric-card:nth-child(4) { animation-delay: 160ms; }

    .project-window.active .reference-card,
    .project-window.active .apple-project-resource-list .reference-card {
      animation: referenceShimmer 420ms var(--micro-ease);
    }

    .reference-card__link:hover .reference-card__title,
    .reference-card__link:focus-visible .reference-card__title {
      text-decoration: underline;
    }

    /* --- Screenshot Gallery & Phone Mockups --- */
    .screenshot-gallery {
      display: flex;
      gap: 20px;
      justify-content: center;
      margin: 16px 0;
      flex-wrap: wrap;
    }

    .phone-mockup {
      background: #1a1a1a;
      border-radius: 28px;
      padding: 12px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
      position: relative;
      width: 200px;
    }

    .phone-notch {
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 80px;
      height: 20px;
      background: #1a1a1a;
      border-radius: 0 0 16px 16px;
      z-index: 1;
    }

    .phone-screen {
      background: white;
      border-radius: 20px;
      overflow: hidden;
      position: relative;
    }

    .phone-screen img {
      width: 100%;
      height: auto;
      display: block;
    }

    /* --- Accessibility --- */
    @media (pointer: coarse) {
      .pupil { display: none; }
    }

    @media (prefers-reduced-motion: reduce) {
      .pupil { transition: none; }
      .window, .contact-link { transition: none; }
      .speech-bubble { animation: none; }
      .terminal-cursor { animation: none; opacity: 1; }
      .online-indicator { animation: none; }
      .project-hero,
      .metric-chip,
      .reference-card {
        transition: none;
        animation: none !important;
      }

      /* Disable iris animations - instant background swap instead */
      .facetime-content.iris-close::before,
      .facetime-content.iris-open::before {
        animation: none;
      }

      .facetime-content.fade-out::before,
      .facetime-content.fade-in::before {
        animation: none;
      }
    }

    /* --- Responsive Mobile Layout --- */
    @media (max-width: 1024px) {
      .desktop {
        padding: 20px 10px 120px;
      }

      /* Show terminal window in vertical stack on mobile */
      .terminal-window {
        display: block;
      }

      /* Hide dashboard widget on mobile */
      .dashboard-widget {
        display: none;
      }

      .window {
        position: relative !important;
        left: auto !important;
        right: auto !important;
        top: auto !important;
        transform: none !important;
        margin: 0 auto 20px;
        max-width: 500px;
        width: calc(100% - 20px);
      }

      .facetime-window {
        max-width: 360px;
      }

      .location-footer {
        font-size: 10px;
        padding: 8px 12px;
      }

      .experience-window,
      .about-window {
        max-height: none;
      }

      .experience-window .window-content {
        max-height: none;
      }

      .project-window {
        position: relative !important;
        transform: none !important;
        margin: 20px auto;
        width: calc(100% - 20px);
        max-width: 550px;
      }

      .apple-project-content {
        grid-template-columns: 1fr;
      }

      .phone-mockup {
        width: 160px;
      }

      .apple-project-hero {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        gap: 20px;
      }

      .apple-project-hero.has-media {
        display: flex;
      }

      .apple-project-hero-media {
        width: 100%;
        max-width: 220px;
      }

      .apple-project-metrics-grid {
        grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
      }

      .dock {
        gap: 8px;
        padding: 6px 12px;
      }

      .dock-icon {
        width: 48px;
        height: 48px;
      }

      .dock-divider {
        height: 40px;
      }
    }

    /* Cursor always blinks on mobile (respects reduced motion preference) */
    @media (max-width: 1024px) and (prefers-reduced-motion: no-preference) {
      .terminal-cursor {
        animation: blink 1s step-end infinite;
      }
    }

    @media (max-width: 480px) {
      .window-content {
        padding: 14px;
      }

      .facetime-window {
        max-width: 100%;
      }

      .dock {
        gap: 6px;
        padding: 4px 8px;
      }

      .dock-icon {
        width: 42px;
        height: 42px;
      }

      .dock-divider {
        height: 36px;
      }

      .phone-mockup {
        width: 140px;
      }

      .screenshot-gallery {
        gap: 12px;
      }
    }
  </style>
</head>
<body>
  <div class="desktop">

    <!-- FaceTime Window (Avatar) -->
    <div class="window facetime-window">
      <div class="window-titlebar">
        <div class="window-controls">
          <div class="window-button close"></div>
          <div class="window-button minimize"></div>
          <div class="window-button maximize"></div>
        </div>
        <div class="window-title">Rhea is calling...</div>
        <div class="theme-toggle active" id="themeToggle" title="Toggle day/night">
          <span class="theme-toggle-icon moon">‚èæ</span>
          <span class="theme-toggle-icon sun">ñ§ì</span>
          <div class="theme-toggle-knob"></div>
        </div>
      </div>
      <div class="window-content facetime-content">
        <div class="avatar-stage" id="stage">
          <div class="avatar-loading" id="avatarLoading" role="status" aria-live="polite">
            <div class="avatar-spinner" aria-hidden="true"></div>
            <span class="sr-only">Loading avatar experience‚Ä¶</span>
          </div>
          <div class="pupil-backdrop"></div>
          <div class="pupil left" id="pupilL"></div>
          <div class="pupil right" id="pupilR"></div>
          <img class="avatar" id="avatarImg" src="assets/avatar_no-eyes.png" alt="Rhea Singh avatar" />
          <div class="speech-bubble speech-bubble--initial">hello world!</div>
        </div>
        <div class="avatar-info">
          <div class="avatar-name">Rhea Singh</div>
          <div class="avatar-subtitle">Software Engineer ¬∑ Product/UX</div>
        </div>
        <!-- Location Footer -->
        <div class="location-footer">
          <span class="online-indicator"></span>
          <span style="font-weight:300;">Open to roles in <span id="sfLocation">SF</span> | <span id="nycLocation">NYC</span> | <span id="nonusLocation">Remote or non-US</span></span>
        </div>
      </div>
    </div>

    <!-- Terminal Window -->
    <div class="window terminal-window">
      <div class="window-titlebar">
        <div class="window-controls">
          <div class="window-button close"></div>
          <div class="window-button minimize"></div>
          <div class="window-button maximize"></div>
        </div>
        <div class="window-title">terminal</div>
      </div>
      <div class="window-content">
        <div class="terminal-prompt">$ status --now</div>
        <div class="terminal-status">
          <span class="terminal-bullet">‚óâ</span>
          <span class="terminal-label">working_on</span>
          <span class="terminal-value">a Sunday crossword</span>
        </div>
        <div class="terminal-status">
          <span class="terminal-bullet">‚óâ</span>
          <span class="terminal-label">reading</span>
          <span class="terminal-value">Dune Messiah</span>
        </div>
        <div style="margin-top: 8px; color: #5c6370;">
          $<span class="terminal-cursor"></span>
        </div>
      </div>
    </div>

    <!-- About/Education Window -->
    <div class="window about-window">
      <div class="window-titlebar">
        <div class="window-controls">
          <div class="window-button close"></div>
          <div class="window-button minimize"></div>
          <div class="window-button maximize"></div>
        </div>
        <div class="window-title">education.txt</div>
        <div style="width: 54px;"></div>
      </div>
      <div class="window-content">
        <div class="info-block">
          <div class="info-title">University of Michigan, College of Engineering</div>
          <div class="info-subtitle">B.S. in Computer Science, History Minor</div>
          <div class="info-meta">2016 - 2020 | Ann Arbor, MI</div>
          <ul class="info-list">
            <li>Operating Systems, Web Systems, UI Development, Computer Security</li>
            <li>Data Structures & Algs, Foundations of Computer Science</li>
            <li>Computer Architecture, Discrete Math, Linear Algebra, Differential Equations</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Experience Window -->
    <div class="window experience-window">
      <div class="window-titlebar">
        <div class="window-controls">
          <div class="window-button close"></div>
          <div class="window-button minimize"></div>
          <div class="window-button maximize"></div>
        </div>
        <div class="window-title">experience.txt</div>
        <div style="width: 54px;"></div>
      </div>
      <div class="window-content">
        <div class="job-item">
          <div class="job-header">
            <div>
              <div class="job-company">Apple, Health & Fitness</div>
              <div class="job-role">Software Engineer</div>
            </div>
            <div class="job-date">Aug 2020 - Sept 2025<br>Cupertino, CA</div>
          </div>
          <ul class="info-list">
            <li>Designed scalable system architectures to power new Health features and improve algorithm performance on iOS and watchOS</li>
            <li>Collaborated with research scientists and cross-functional teams to run FDA-regulated studies as part of a multi-year flagship feature</li>
            <li>Built and owned research apps to test experimental Health & Fitness features and collect secure, high-fidelity sensor data</li>
            <li>Architected efficient APIs and background systems balancing power, performance, and resource constraints</li>
            <li>Coordinated priorities across data, infrastructure, and product teams to meet ambitious delivery goals</li>
            <li>Presented designs and trade-offs to executives and experts to align on technical direction</li>
          </ul>
        </div>

        <div class="job-item">
          <div class="job-header">
            <div>
              <div class="job-company">Capital One</div>
              <div class="job-role">Tech Intern</div>
            </div>
            <div class="job-date">June - Aug 2019<br>Chicago, IL</div>
          </div>
          <ul class="info-list">
            <li>Improved user experience for new partnership application based on feedback from previous rollouts</li>
            <li>Developed metrics for team efficiency in the development process</li>
            <li>Designed a beautiful, easy-to-understand data visualization tool of team's Github pull request process</li>
          </ul>
        </div>

        <div class="job-item">
          <div class="job-header">
            <div>
              <div class="job-company">Blablablab (UMich)</div>
              <div class="job-role"><i>The Bringing together Language and Behavior for Large-scale Analytical Breakthroughs Laboratory</i></div>
              <div class="job-role">Undergraduate Researcher</div>
            </div>
            <div class="job-date">2018 - 2020<br>Ann Arbor, MI</div>
          </div>
          <ul class="info-list">
            <li>Scraped Wikipedia for all people with pages and identified gender based on names and pronouns</li>
            <li>Applied NLP techniques to derive statistically significant differences in language used dependent on gender</li>
            <li>Thought critically in collaboration with professor about data and potential biases</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Skills Window -->
    <div class="window skills-window">
      <div class="window-titlebar">
        <div class="window-controls">
          <div class="window-button close"></div>
          <div class="window-button minimize"></div>
          <div class="window-button maximize"></div>
        </div>
        <div class="window-title">/Users/rhea/skills/</div>
        <div style="width: 54px;"></div>
      </div>
      <div class="window-content">
        <div class="file-explorer">
          <!-- Backend Folder -->
          <div class="folder">
            <div class="folder-header" onclick="toggleFolder(this)">
              <span class="folder-arrow">‚ñº</span>
              <img src="assets/icon-folder.png" alt="" class="folder-icon" />
              <span class="folder-name">backend</span>
            </div>
            <div class="folder-content">
              <div class="file"><img src="assets/icon-file.png" alt="" class="folder-icon" /> .cpp</div>
              <div class="file"><img src="assets/icon-file.png" alt="" class="folder-icon" /> .py</div>
              <div class="file"><img src="assets/icon-file.png" alt="" class="folder-icon" /> .sql</div>
              <div class="file"><span class="file-icon">‚óè</span> API + SDK Development</div>
              <div class="file"><span class="file-icon">‚óè</span> Multithreaded OS</div>
            </div>
          </div>

          <!-- Frontend Folder -->
          <div class="folder">
            <div class="folder-header" onclick="toggleFolder(this)">
              <span class="folder-arrow">‚ñº</span>
              <img src="assets/icon-folder.png" alt="" class="folder-icon" />
              <span class="folder-name">frontend</span>
            </div>
            <div class="folder-content">
              <div class="file"><img src="assets/icon-file.png" alt="" class="folder-icon" /> .swift</div>
              <div class="file"><img src="assets/icon-file.png" alt="" class="folder-icon" /> .m/.mm</div>
              <div class="file"><img src="assets/icon-file.png" alt="" class="folder-icon" /> .html</div>
              <div class="file"><img src="assets/icon-file.png" alt="" class="folder-icon" /> .css</div>
              <div class="file"><img src="assets/icon-file.png" alt="" class="folder-icon" /> .js</div>
              <div class="file"><img src="assets/icon-file.png" alt="" class="folder-icon" /> .react</div>
              <div class="file"><span class="file-icon">‚óè</span> iOS + Xcode</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Extracurriculars Window -->
    <div class="window extra-window">
      <div class="window-titlebar">
        <div class="window-controls">
          <div class="window-button close"></div>
          <div class="window-button minimize"></div>
          <div class="window-button maximize"></div>
        </div>
        <div class="window-title">Extracurriculars</div>
        <div style="width: 54px;"></div>
      </div>
      <div class="window-content">
        <div class="job-item">
          <div class="job-header">
            <div>
              <div class="job-company">ICPC (Programming Contest)</div>
              <div class="job-role">Participant</div>
            </div>
            <div class="job-date">Sept 2018 - 2020</div>
          </div>
          <ul class="info-list">
            <li>Qualified for ICPC State Level with team of three</li>
            <li>Placed in top five, working on challenging programming questions</li>
          </ul>
        </div>

        <div class="job-item">
          <div class="job-header">
            <div>
              <div class="job-company">Michigan Research Community</div>
              <div class="job-role">Peer Mentor</div>
            </div>
            <div class="job-date">Sept 2016 - May 2018</div>
          </div>
          <ul class="info-list">
            <li>Guided first-time undergraduate research students in navigating project search and research path</li>
            <li>Provided support, monthly meetings, and guidance with research posters</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Project Windows (Hidden by default) -->
    <!-- NYT Spelling Bee Project Window -->
    <div class="window project-window" id="spellingBeeWindow">
      <div class="window-titlebar">
        <div class="window-controls">
          <div class="window-button close" onclick="closeProjectWindow('spellingBeeWindow')"></div>
          <div class="window-button minimize"></div>
          <div class="window-button maximize"></div>
        </div>
        <div class="window-title">spelling-bee</div>
        <div style="width: 54px;"></div>
      </div>
      <div class="window-content">
        <div class="section-heading">Project Overview</div>
        <p style="font-size: 13px; line-height: 1.6; color: var(--text-dark); margin-bottom: 12px;">
          A real-time interactive version of the New York Times Spelling Bee made to compete with friends and family. Updates daily when the new puzzle drops.
        </p>
        <div class="project-actions">
          <a href="https://frankies-spelling-bee.vercel.app" class="project-launch" target="_blank">
            <span>Launch</span>
            <span aria-hidden="true">üöÄ</span>
          </a>
          <a href="https://github.com/rhea-s/spelling-bee/tree/main" class="project-icon-link" target="_blank" aria-label="View project on GitHub">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <path d="M12 2C6.48 2 2 6.58 2 12.25c0 4.52 2.87 8.36 6.84 9.72.5.1.68-.22.68-.49 0-.24-.01-.87-.01-1.71-2.78.62-3.37-1.37-3.37-1.37-.45-1.18-1.1-1.5-1.1-1.5-.9-.63.07-.62.07-.62 1 .07 1.53 1.06 1.53 1.06.89 1.56 2.34 1.11 2.91.85.09-.66.35-1.11.63-1.37-2.22-.26-4.56-1.14-4.56-5.07 0-1.12.39-2.03 1.03-2.75-.1-.26-.45-1.3.1-2.71 0 0 .84-.27 2.75 1.05a9.3 9.3 0 0 1 5 0c1.9-1.32 2.74-1.05 2.74-1.05.55 1.41.2 2.45.1 2.71.64.72 1.03 1.63 1.03 2.75 0 3.94-2.34 4.81-4.57 5.06.36.33.68.97.68 1.96 0 1.42-.01 2.56-.01 2.9 0 .27.18.6.69.49A10.03 10.03 0 0 0 22 12.25C22 6.58 17.52 2 12 2Z" fill="currentColor" />
            </svg>
            <span class="sr-only">View on GitHub</span>
          </a>
        </div>
        <div class="section-heading">Tech Stack</div>
        <div class="skill-tags" style="margin-bottom: 16px;">
          <span class="skill-tag">JavaScript</span>
          <span class="skill-tag">CSS</span>
          <span class="skill-tag">Python Scripting</span>
          <span class="skill-tag">Firebase</span>
          <span class="skill-tag">Claude Code</span>
          <!-- Add more tech stack tags as needed -->
        </div>

        <div class="section-heading">Screenshots</div>
        <div class="screenshot-gallery">
          <div class="phone-mockup">
            <div class="phone-notch"></div>
            <div class="phone-screen">
              <img src="assets/spellingbee-ex1.PNG" alt="Spelling Bee Screenshot 1" />
            </div>
          </div>
          <div class="phone-mockup">
            <div class="phone-notch"></div>
            <div class="phone-screen">
              <img src="assets/spellingbee-ex2.PNG" alt="Spelling Bee Screenshot 2" />
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Book Club Project Window -->
    <div class="window project-window" id="bookClubWindow">
      <div class="window-titlebar">
        <div class="window-controls">
          <div class="window-button close" onclick="closeProjectWindow('bookClubWindow')"></div>
          <div class="window-button minimize"></div>
          <div class="window-button maximize"></div>
        </div>
        <div class="window-title">book-club</div>
        <div style="width: 54px;"></div>
      </div>
      <div class="window-content">
        <div style="text-align: center; padding: 40px 20px;">
          <p style="font-size: 18px; font-weight: 600; color: var(--text-dark); margin-bottom: 8px;">
            üöß Under Construction üöß
          </p>
          <p style="font-size: 13px; color: var(--text-muted);">
            Check back soon!
          </p>
        </div>
      </div>
    </div>

    <!-- Work Window (Finder-style project grid) -->
    <div class="window project-window" id="workWindow">
      <div class="window-titlebar">
        <div class="window-controls">
          <div class="window-button close" onclick="closeProjectWindow('workWindow')"></div>
          <div class="window-button minimize"></div>
          <div class="window-button maximize"></div>
        </div>
        <div class="window-title">Apple Projects</div>
        <div style="width: 54px;"></div>
      </div>
      <div class="window-content">
        <div class="project-grid" id="appleProjectGrid" role="list"></div>
      </div>
    </div>

    <div id="appleProjectWindowsContainer"></div>

    <!-- Dashboard Widget (Terminal) -->
    <div class="dashboard-widget">
      <div class="dashboard-titlebar">
        <div class="terminal-dots">
          <div class="terminal-dot red"></div>
          <div class="terminal-dot yellow"></div>
          <div class="terminal-dot green"></div>
        </div>
        <div class="dashboard-title">terminal</div>
      </div>
      <div class="dashboard-content">
        <div class="terminal-prompt">$ status --now</div>
        <div class="terminal-status">
          <span class="terminal-bullet">‚óâ</span>
          <span class="terminal-label">working_on</span>
          <span class="terminal-value">a Sunday crossword</span>
        </div>
        <div class="terminal-status">
          <span class="terminal-bullet">‚óâ</span>
          <span class="terminal-label">reading</span>
          <span class="terminal-value">Dune Messiah</span>
        </div>
        <div style="margin-top: 8px; color: #5c6370;">
          $<span class="terminal-cursor"></span>
        </div>
      </div>
    </div>

    <!-- Dock Container -->
    <div style="position: fixed; bottom: 16px; left: 50%; transform: translateX(-50%); display: flex; gap: 12px; z-index: 1000;">
      <!-- Projects Dock -->
      <div class="dock">
        <!-- NYT Spelling Bee App Icon -->
        <div class="dock-icon" onclick="openProjectWindow('spellingBeeWindow')">
          <img src="assets/spelling-bee-logo.png" alt="Spelling Bee" />
          <div class="dock-tooltip">spelling-bee</div>
        </div>

        <!-- Book Club App Icon -->
        <div class="dock-icon" onclick="openProjectWindow('bookClubWindow')">
          <img src="assets/icon-book-club.png" alt="Book Club" />
          <div class="dock-tooltip">book-club</div>
        </div>

        <div class="dock-divider"></div>

        <!-- Work/Apple Projects Icon -->
        <div class="dock-icon" onclick="openProjectWindow('workWindow')">
          <img src="assets/icon-apple.png" alt="Work Projects" />
          <div class="dock-tooltip">apple-work</div>
        </div>
      </div>

      <!-- Contact Dock -->
      <div class="dock">
        <!-- Mail App Icon -->
        <a href="mailto:singh.rhea.04@gmail.com" class="dock-icon">
          <img src="assets/icon-mail.png" alt="Email" />
          <div class="dock-tooltip">send email</div>
        </a>

        <!-- LinkedIn App Icon -->
        <a href="https://linkedin.com/in/rheas" target="_blank" class="dock-icon">
          <img src="assets/icon-linkedin.png" alt="LinkedIn" />
          <div class="dock-tooltip">connect</div>
        </a>
      </div>
    </div>

  </div>

  <script>
    let appleProjectsData = [];
    let zIndexCounter = 100;

    const avatarImgEl = document.getElementById('avatarImg');
    const avatarLoading = document.getElementById('avatarLoading');
    const PUPIL_SPRITE_URL = 'assets/avatar_eye-pupil.png';
    let backgroundLoadPromise = null;

    function waitForImageElement(img) {
      if (!img) return Promise.resolve();
      if (img.complete && img.naturalWidth > 0) {
        return Promise.resolve();
      }

      return new Promise((resolve, reject) => {
        const cleanup = () => {
          img.removeEventListener('load', onLoad);
          img.removeEventListener('error', onError);
        };

        const onLoad = () => {
          cleanup();
          resolve();
        };

        const onError = (event) => {
          cleanup();
          reject(event);
        };

        img.addEventListener('load', onLoad, { once: true });
        img.addEventListener('error', onError, { once: true });
      });
    }

    function preloadImage(url) {
      if (!url) return Promise.resolve();

      return new Promise((resolve, reject) => {
        const image = new Image();
        image.decoding = 'async';

        const cleanup = () => {
          image.onload = null;
          image.onerror = null;
        };

        image.onload = () => {
          cleanup();
          resolve(url);
        };

        image.onerror = (event) => {
          cleanup();
          reject(event);
        };

        image.src = url;

        if (image.complete && image.naturalWidth > 0) {
          cleanup();
          resolve(url);
        }
      });
    }

    function withTimeout(promise, ms = 8000) {
      return new Promise((resolve) => {
        const timeoutId = setTimeout(() => {
          resolve('timeout');
        }, ms);

        promise
          .then((value) => {
            clearTimeout(timeoutId);
            resolve(value);
          })
          .catch((error) => {
            clearTimeout(timeoutId);
            console.warn('Avatar assets failed to load in time:', error);
            resolve();
          });
      });
    }

    function ensureBackgroundPreload(url) {
      if (!url) return Promise.resolve();

      backgroundLoadPromise = preloadImage(url).catch((error) => {
        console.warn('Background failed to preload:', error);
        return undefined;
      });

      return backgroundLoadPromise;
    }

    function hideAvatarLoader() {
      if (!avatarLoading || avatarLoading.classList.contains('is-hidden')) {
        return;
      }

      avatarLoading.classList.add('is-hidden');
      avatarLoading.setAttribute('aria-hidden', 'true');
    }

    function setupAvatarLoader() {
      if (!avatarLoading) return;
      
      const assetPromises = [
        waitForImageElement(avatarImgEl),
        preloadImage(PUPIL_SPRITE_URL)
      ];

      const currentBackgroundUrl = getCurrentBackgroundUrl();
      const backgroundPromise = backgroundLoadPromise
        || (currentBackgroundUrl ? ensureBackgroundPreload(currentBackgroundUrl) : null);

      if (backgroundPromise) {
        assetPromises.push(backgroundPromise);
      }

      const combinedPromise = Promise.allSettled(assetPromises);

      withTimeout(combinedPromise, 8000).then(() => {
        hideAvatarLoader();
      });

      if (document.readyState === 'complete') {
        hideAvatarLoader();
      } else {
        window.addEventListener('load', hideAvatarLoader, { once: true });
      }
    }

    // Eye-tracking logic with rAF throttling and clamped movement within a circle.
    (function () {
      const stage = document.getElementById('stage');
      const left = document.getElementById('pupilL');
      const right = document.getElementById('pupilR');
      const avatarImg = avatarImgEl;

      // Respect: reduced motion and non-fine pointers (phones/tablets)
      const motionOK = !window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      const finePointer = window.matchMedia('(pointer: fine)').matches;

      // If on mobile (coarse pointer), use the complete avatar with eyes
      if (!finePointer) {
        avatarImg.src = 'assets/avatar_base-complete-transparent.png';
      }

      if (!motionOK || !finePointer) return; // bail out

      const MAX = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--pupil-radius')) || 7;

      let queued = false;
      let lastEvent = null;

      function clampMove(pupil, center) {
        const rect = stage.getBoundingClientRect();
        // Cursor position relative to stage
        const x = lastEvent.clientX - rect.left;
        const y = lastEvent.clientY - rect.top;

        const dx = x - center.x;
        const dy = y - center.y;
        const dist = Math.hypot(dx, dy) || 1;
        const m = Math.min(MAX, dist);
        const nx = (dx / dist) * m;
        const ny = (dy / dist) * m;

        pupil.style.transform = `translate(calc(-50% + ${nx}px), calc(-55% + ${ny}px))`;
      }

      function getCenter(pupil) {
        const r = pupil.getBoundingClientRect();
        return { x: r.left + r.width / 2 - stage.getBoundingClientRect().left,
                 y: r.top + r.height / 2 - stage.getBoundingClientRect().top };
      }

      function onMove(e) {
        lastEvent = e;
        if (!queued) {
          queued = true;
          requestAnimationFrame(() => {
            const cL = getCenter(left);
            const cR = getCenter(right);
            clampMove(left,  cL);
            clampMove(right, cR);
            queued = false;
          });
        }
      }

      function recenter() {
        left.style.transform = 'translate(-50%, -50%)';
        right.style.transform = 'translate(-50%, -50%)';
      }

      document.addEventListener('mousemove', onMove);
      window.addEventListener('resize', recenter);
    })();

    // Window click-to-front functionality
    function bringWindowToFront(windowEl) {
      if (!windowEl) return;
      zIndexCounter += 1;
      windowEl.style.zIndex = zIndexCounter;
    }

    function registerWindow(windowEl) {
      if (!windowEl) return;
      windowEl.addEventListener('click', () => bringWindowToFront(windowEl));
    }

    function createSectionHeading(text) {
      const heading = document.createElement('div');
      heading.className = 'section-heading';
      heading.textContent = text;
      return heading;
    }

    const referenceTypeSlug = type => (type || '').toLowerCase().replace(/[^a-z0-9]+/g, '-').replace(/^-|-$/g, '') || 'resource';

    function createReferenceMedia(entry) {
      const mediaWrapper = document.createElement('div');
      mediaWrapper.className = 'reference-card__media';

      const hasAvatar = Boolean(entry && entry.avatar);
      const mediaSrc = (entry && (entry.avatar || entry.image || entry.icon)) || null;
      if (mediaSrc) {
        const img = document.createElement('img');
        img.src = mediaSrc;
        const altSeed = (entry && (entry.mediaAlt || entry.source || entry.title || entry.label)) || 'Reference';
        img.alt = hasAvatar ? `${altSeed} avatar` : `${altSeed} logo`;
        img.loading = 'lazy';
        mediaWrapper.appendChild(img);
        return mediaWrapper;
      }

      const fallbackSeed = ((entry && (entry.badge || entry.source || entry.title || entry.label)) || '').trim();
      if (!fallbackSeed) {
        return null;
      }

      const fallback = document.createElement('div');
      fallback.className = 'reference-card__fallback';
      fallback.textContent = fallbackSeed.charAt(0).toUpperCase();
      mediaWrapper.appendChild(fallback);
      return mediaWrapper;
    }

    function createReferenceCard(entry) {
      if (!entry || !entry.link) {
        return null;
      }

      const normalizedType = (entry.type || '').toLowerCase();
      const isTweet = normalizedType.includes('tweet');
      const isPress = normalizedType.includes('press') || normalizedType.includes('news') || normalizedType.includes('article');

      const article = document.createElement('article');
      article.className = 'reference-card';
      article.setAttribute('role', 'listitem');

      const slug = referenceTypeSlug(entry.type);
      if (slug) {
        article.classList.add(`reference-card--${slug}`);
      }

      if (isTweet) {
        article.classList.add('reference-card--tweet');
      } else if (isPress) {
        article.classList.add('reference-card--press');
      } else {
        article.classList.add('reference-card--resource');
      }

      const anchor = document.createElement('a');
      anchor.href = entry.link;
      anchor.target = '_blank';
      anchor.rel = 'noopener noreferrer';
      anchor.className = 'reference-card__link';

      const ariaLabelParts = [];
      if (entry.title) {
        ariaLabelParts.push(entry.title);
      } else if (entry.label) {
        ariaLabelParts.push(entry.label);
      }
      if (entry.source) {
        ariaLabelParts.push(`from ${entry.source}`);
      }
      const ariaLabel = ariaLabelParts.join(' ');
      if (ariaLabel) {
        anchor.setAttribute('aria-label', `Open ${ariaLabel}`);
      } else {
        anchor.setAttribute('aria-label', 'Open external resource');
      }

      const media = createReferenceMedia(entry);
      if (media) {
        anchor.appendChild(media);
      } else {
        anchor.classList.add('reference-card__link--no-media');
      }

      const body = document.createElement('div');
      body.className = 'reference-card__body';

      if (entry.type) {
        const typeLabel = document.createElement('span');
        typeLabel.className = 'reference-card__type';
        typeLabel.textContent = entry.type;
        body.appendChild(typeLabel);
      }

      if (isTweet) {
        if (entry.title || entry.source) {
          const authorRow = document.createElement('div');
          authorRow.className = 'reference-card__tweet-author';

          if (entry.title) {
            const nameEl = document.createElement('span');
            nameEl.className = 'reference-card__title';
            nameEl.textContent = entry.title;
            authorRow.appendChild(nameEl);
          }

          if (entry.source) {
            const handleEl = document.createElement('span');
            handleEl.className = 'reference-card__tweet-handle';
            handleEl.textContent = entry.source;
            authorRow.appendChild(handleEl);
          }

          body.appendChild(authorRow);
        }

        if (entry.excerpt || entry.quote) {
          const tweetText = document.createElement('p');
          tweetText.className = 'reference-card__excerpt reference-card__excerpt--tweet';
          tweetText.textContent = entry.excerpt || entry.quote;
          body.appendChild(tweetText);
        }

        const metaParts = [];
        if (entry.timestamp) {
          metaParts.push(entry.timestamp);
        }
        if (entry.meta) {
          metaParts.push(entry.meta);
        }
        if (metaParts.length) {
          const meta = document.createElement('div');
          meta.className = 'reference-card__meta';
          meta.textContent = metaParts.join(' ¬∑ ');
          body.appendChild(meta);
        }
      } else {
        const titleText = entry.title || entry.label || '';
        if (titleText) {
          const titleEl = document.createElement('div');
          titleEl.className = 'reference-card__title';
          titleEl.textContent = titleText;
          body.appendChild(titleEl);
        }

        if (entry.excerpt || entry.quote || entry.description) {
          const excerptEl = document.createElement('p');
          excerptEl.className = 'reference-card__excerpt';
          excerptEl.textContent = entry.excerpt || entry.quote || entry.description;
          body.appendChild(excerptEl);
        }

        const metaParts = [];
        if (entry.source) {
          metaParts.push(entry.source);
        }
        if (entry.meta) {
          metaParts.push(entry.meta);
        }
        if (entry.timestamp && !metaParts.includes(entry.timestamp)) {
          metaParts.push(entry.timestamp);
        }
        if (entry.host) {
          metaParts.push(entry.host);
        }

        if (metaParts.length) {
          const meta = document.createElement('div');
          meta.className = 'reference-card__meta';
          meta.textContent = metaParts.join(' ¬∑ ');
          body.appendChild(meta);
        }
      }

      anchor.appendChild(body);
      article.appendChild(anchor);
      return article;
    }

    function showAppleProjectsError() {
      const grid = document.getElementById('appleProjectGrid');
      const windowsContainer = document.getElementById('appleProjectWindowsContainer');

      if (grid) {
        grid.innerHTML = '';
        const message = document.createElement('div');
        message.className = 'apple-projects-empty';
        message.textContent = 'Project data is unavailable right now. Please refresh or try again later.';
        grid.appendChild(message);
      }

      if (windowsContainer) {
        windowsContainer.innerHTML = '';
      }
    }

    function buildAppleProjectWindow(project, windowId) {
      const windowEl = document.createElement('div');
      windowEl.className = 'window project-window apple-project-window';
      windowEl.id = windowId;

      const titlebar = document.createElement('div');
      titlebar.className = 'window-titlebar';

      const controls = document.createElement('div');
      controls.className = 'window-controls';

      const closeButton = document.createElement('div');
      closeButton.className = 'window-button close';
      closeButton.addEventListener('click', () => closeProjectWindow(windowId));

      const minimizeButton = document.createElement('div');
      minimizeButton.className = 'window-button minimize';

      const maximizeButton = document.createElement('div');
      maximizeButton.className = 'window-button maximize';

      controls.append(closeButton, minimizeButton, maximizeButton);

      const title = document.createElement('div');
      title.className = 'window-title';
      title.textContent = project.title;

      const spacer = document.createElement('div');
      spacer.style.width = '54px';

      titlebar.append(controls, title, spacer);

      const content = document.createElement('div');
      content.className = 'window-content apple-project-content';

      const heroSection = document.createElement('section');
      heroSection.className = 'apple-project-section apple-project-hero project-hero';

      const heroBody = document.createElement('div');
      heroBody.className = 'apple-project-hero-body';

      if (project.hero && project.hero.eyebrow) {
        const eyebrow = document.createElement('div');
        eyebrow.className = 'hero-eyebrow';
        eyebrow.textContent = project.hero.eyebrow;
        heroBody.appendChild(eyebrow);
      }

      const headline = document.createElement('h3');
      headline.className = 'hero-headline';
      headline.textContent = (project.hero && project.hero.headline) || project.title;
      heroBody.appendChild(headline);

      if (project.hero && project.hero.subhead) {
        const subhead = document.createElement('div');
        subhead.className = 'hero-subhead';
        subhead.textContent = project.hero.subhead;
        heroBody.appendChild(subhead);
      }

      if (project.hero && project.hero.summary) {
        const summary = document.createElement('p');
        summary.className = 'hero-summary';
        summary.textContent = project.hero.summary;
        heroBody.appendChild(summary);
      }

      const metrics = Array.isArray(project.metrics) ? [...project.metrics] : [];
      const heroKeyMetric = metrics.length ? metrics.shift() : null;

      if (heroKeyMetric && (heroKeyMetric.value || heroKeyMetric.label)) {
        const heroStat = document.createElement('div');
        heroStat.className = 'apple-project-hero-stat metric-chip';

        if (heroKeyMetric.value) {
          const value = document.createElement('div');
          value.className = 'apple-project-hero-stat-value';
          value.textContent = heroKeyMetric.value;
          heroStat.appendChild(value);
        }

        if (heroKeyMetric.label) {
          const label = document.createElement('div');
          label.className = 'apple-project-hero-stat-label';
          label.textContent = heroKeyMetric.label;
          heroStat.appendChild(label);
        }

        heroBody.appendChild(heroStat);
      }

      heroSection.appendChild(heroBody);

      if (project.assets && project.assets.heroImage) {
        const heroMedia = document.createElement('div');
        heroMedia.className = 'apple-project-hero-media';
        const img = document.createElement('img');
        img.src = project.assets.heroImage;
        img.alt = project.assets.heroAlt || `${project.title} imagery`;
        heroMedia.appendChild(img);
        heroSection.classList.add('has-media');
        heroSection.appendChild(heroMedia);
      }

      content.appendChild(heroSection);

      if (metrics.length) {
        const metricsSection = document.createElement('section');
        metricsSection.className = 'apple-project-section apple-project-metrics-section';
        metricsSection.appendChild(createSectionHeading('Supporting Metrics'));

        const metricsGrid = document.createElement('div');
        metricsGrid.className = 'apple-project-metrics-grid';
        let hasMetricCards = false;

        metrics.forEach(metric => {
          if (!metric) return;
          const metricCard = document.createElement('div');
          metricCard.className = 'apple-project-metric-card metric-chip';
          let hasContent = false;

          if (metric.value) {
            const value = document.createElement('span');
            value.className = 'apple-project-metric-value';
            value.textContent = metric.value;
            metricCard.appendChild(value);
            hasContent = true;
          }

          if (metric.label) {
            const label = document.createElement('span');
            label.className = 'apple-project-metric-label';
            label.textContent = metric.label;
            metricCard.appendChild(label);
            hasContent = true;
          }

          if (hasContent) {
            metricsGrid.appendChild(metricCard);
            hasMetricCards = true;
          }
        });

        if (hasMetricCards) {
          metricsSection.appendChild(metricsGrid);
          content.appendChild(metricsSection);
        }
      }

      if (Array.isArray(project.tech) && project.tech.length) {
        const techSection = document.createElement('section');
        techSection.className = 'apple-project-section apple-project-tech';
        techSection.appendChild(createSectionHeading('Tech Stack'));
        const tagWrapper = document.createElement('div');
        tagWrapper.className = 'skill-tags';
        project.tech.forEach(tag => {
          const span = document.createElement('span');
          span.className = 'skill-tag';
          span.textContent = tag;
          tagWrapper.appendChild(span);
        });
        techSection.appendChild(tagWrapper);
        content.appendChild(techSection);
      }

      if (Array.isArray(project.highlights) && project.highlights.length) {
        const featureSection = document.createElement('section');
        featureSection.className = 'apple-project-section apple-project-features';
        featureSection.appendChild(createSectionHeading(project.highlightsHeading || 'Highlights'));
        const list = document.createElement('ul');
        list.className = 'info-list apple-project-feature-list';

        project.highlights.forEach(highlight => {
          const li = document.createElement('li');
          const hasLabel = Boolean(highlight && highlight.label);
          const hasDescription = Boolean(highlight && highlight.description);

          if (hasLabel) {
            const strong = document.createElement('strong');
            strong.textContent = hasDescription ? `${highlight.label}:` : highlight.label;
            li.appendChild(strong);
            if (hasDescription) {
              li.appendChild(document.createTextNode(` ${highlight.description}`));
            }
          } else if (hasDescription) {
            li.textContent = highlight.description;
          }

          list.appendChild(li);
        });

        featureSection.appendChild(list);
        content.appendChild(featureSection);
      }

      if (Array.isArray(project.references) && project.references.length) {
        const referenceSection = document.createElement('section');
        referenceSection.className = 'apple-project-section apple-project-references';
        referenceSection.appendChild(createSectionHeading(project.referencesHeading || 'References'));
        const cards = document.createElement('div');
        cards.className = 'apple-project-reference-gallery';
        cards.setAttribute('role', 'list');

        let hasReferenceCards = false;
        project.references.forEach(ref => {
          const card = createReferenceCard(ref);
          if (card) {
            cards.appendChild(card);
            hasReferenceCards = true;
          }
        });

        if (hasReferenceCards) {
          referenceSection.appendChild(cards);
          content.appendChild(referenceSection);
        }
      }

      if (Array.isArray(project.links) && project.links.length) {
        const resourcesSection = document.createElement('section');
        resourcesSection.className = 'apple-project-section apple-project-resources';
        resourcesSection.appendChild(createSectionHeading(project.linksHeading || 'Resources'));
        const linksContainer = document.createElement('div');
        linksContainer.className = 'apple-project-resource-list';
        linksContainer.setAttribute('role', 'list');

        let hasResourceCards = false;
        project.links.forEach(link => {
          const card = createReferenceCard({
            ...link,
            link: link.url || link.link
          });

          if (card) {
            linksContainer.appendChild(card);
            hasResourceCards = true;
          }
        });

        if (hasResourceCards) {
          resourcesSection.appendChild(linksContainer);
          content.appendChild(resourcesSection);
        }
      }

      windowEl.append(titlebar, content);
      return windowEl;
    }

    function renderAppleProjects() {
      const grid = document.getElementById('appleProjectGrid');
      const windowsContainer = document.getElementById('appleProjectWindowsContainer');

      if (!grid || !windowsContainer) {
        return;
      }

      grid.innerHTML = '';
      windowsContainer.innerHTML = '';

      appleProjectsData.forEach(project => {
        const windowId = `appleProject-${project.id}`;

        const gridItem = document.createElement('div');
        gridItem.className = 'project-grid-item';
        gridItem.setAttribute('role', 'button');
        gridItem.setAttribute('tabindex', '0');
        gridItem.dataset.windowId = windowId;

        const iconWrap = document.createElement('div');
        iconWrap.className = 'project-grid-icon';
        const icon = document.createElement('img');
        icon.src = (project.assets && project.assets.icon) || 'assets/icon-apple.png';
        icon.alt = (project.assets && project.assets.iconAlt) || `${project.title} icon`;
        iconWrap.appendChild(icon);
        gridItem.appendChild(iconWrap);

        const label = document.createElement('div');
        label.className = 'project-grid-label';
        label.textContent = project.shortTitle || project.title;
        gridItem.appendChild(label);

        const openHandler = () => openAppleProject(windowId);
        gridItem.addEventListener('click', openHandler);
        gridItem.addEventListener('keydown', event => {
          if (event.key === 'Enter' || event.key === ' ') {
            event.preventDefault();
            openHandler();
          }
        });

        grid.appendChild(gridItem);

        const projectWindow = buildAppleProjectWindow(project, windowId);
        windowsContainer.appendChild(projectWindow);
        registerWindow(projectWindow);
      });
    }

    async function loadAppleProjects() {
      try {
        const response = await fetch('assets/data/appleProjects.json', { cache: 'no-cache' });
        if (!response.ok) {
          throw new Error(`Request failed with status ${response.status}`);
        }

        const data = await response.json();
        if (!Array.isArray(data)) {
          throw new Error('Unexpected data format');
        }

        appleProjectsData = data;
        renderAppleProjects();
      } catch (error) {
        console.warn('Failed to load Apple projects dataset:', error);
        showAppleProjectsError();
      }
    }

    document.querySelectorAll('.window').forEach(registerWindow);

    // Location and Theme Management
    let currentLocation = 'sf';
    let isDayMode = true;
    const speechBubble = document.querySelector('.speech-bubble');
    let hasUserChangedLocation = false;
    const canAnimateGreeting = !window.matchMedia('(prefers-reduced-motion: reduce)').matches;
    let activeSpeechBubbleAnimationCleanup = null;
    let hasClearedInitialSpeechBubble = false;

    function applyGreeting({ animate = false } = {}) {
      if (!speechBubble) {
        return;
      }

      const locationLabels = {
        sf: 'SF',
        nyc: 'NYC',
        nonus: 'world'
      };

      const activeLabel = hasUserChangedLocation
        ? (locationLabels[currentLocation] || 'world')
        : 'world';
      const displayLabel = activeLabel === 'world' ? 'world' : activeLabel;
      const message = isDayMode
        ? `hello ${displayLabel}!`
        : `gn, ${displayLabel} :)`;

      const targetNightMode = !isDayMode;
      const isNightModeApplied = speechBubble.classList.contains('speech-bubble--night');
      const shouldToggleTheme = isNightModeApplied !== targetNightMode;

      if (activeSpeechBubbleAnimationCleanup) {
        activeSpeechBubbleAnimationCleanup();
        activeSpeechBubbleAnimationCleanup = null;
      }

      const messageChanged = speechBubble.textContent !== message;

      if (!hasClearedInitialSpeechBubble && messageChanged) {
        speechBubble.classList.remove('speech-bubble--initial');
        hasClearedInitialSpeechBubble = true;
      }

      const shouldAnimate = animate && canAnimateGreeting && messageChanged;

      if (!shouldAnimate) {
        if (shouldToggleTheme) {
          speechBubble.classList.toggle('speech-bubble--night', targetNightMode);
        }
        if (messageChanged) {
          speechBubble.textContent = message;
        }
        return;
      }

      let enterHandler = null;

      function cleanupAnimation() {
        speechBubble.removeEventListener('animationend', exitHandler);
        if (enterHandler) {
          speechBubble.removeEventListener('animationend', enterHandler);
        }
        speechBubble.classList.remove('speech-bubble--exiting', 'speech-bubble--entering');
        activeSpeechBubbleAnimationCleanup = null;
        enterHandler = null;
      }

      function exitHandler(event) {
        if (event.target !== speechBubble || event.animationName !== 'bubbleSlideOut') {
          return;
        }

        speechBubble.removeEventListener('animationend', exitHandler);
        speechBubble.classList.remove('speech-bubble--exiting');
        if (shouldToggleTheme) {
          speechBubble.classList.toggle('speech-bubble--night', targetNightMode);
        }
        speechBubble.textContent = message;
        speechBubble.classList.add('speech-bubble--entering');

        enterHandler = function (enterEvent) {
          if (enterEvent.target !== speechBubble || enterEvent.animationName !== 'bubbleSlideIn') {
            return;
          }

          cleanupAnimation();
        };

        speechBubble.addEventListener('animationend', enterHandler);
      }

      activeSpeechBubbleAnimationCleanup = cleanupAnimation;
      speechBubble.addEventListener('animationend', exitHandler);
      speechBubble.classList.add('speech-bubble--exiting');
    }

    // Background image mapping
    const backgrounds = {
      sf: {
        day: 'assets/sf-background-day.png',
        night: 'assets/sf-background-night.png'
      },
      nyc: {
        day: 'assets/nyc-background-day-2.png',
        night: 'assets/nyc-background-night-2.png'
      },
      nonus: {
        day: 'assets/bliss-background.png',
        night: 'assets/bliss-background-night.png'
      }
    };

    function getCurrentBackgroundUrl(location = currentLocation, mode = isDayMode ? 'day' : 'night') {
      const locationBackgrounds = backgrounds[location];
      return locationBackgrounds ? locationBackgrounds[mode] : undefined;
    }

    let backgroundTransitionToken = 0;
    const activeAnimationCleanups = new Set();

    function resetFacetimeAnimation() {
      const facetimeContent = document.querySelector('.facetime-content');
      activeAnimationCleanups.forEach(cleanup => cleanup());
      activeAnimationCleanups.clear();
      if (facetimeContent) {
        facetimeContent.classList.remove('iris-close', 'iris-open', 'fade-out', 'fade-in');
      }
    }

    function waitForFacetimeAnimation(element, animationName, token) {
      if (!element) return Promise.resolve();

      return new Promise(resolve => {
        let finished = false;

        const cleanup = () => {
          if (finished) return;
          finished = true;
          element.removeEventListener('animationend', handleAnimationEnd);
          activeAnimationCleanups.delete(cleanup);
          resolve();
        };

        const handleAnimationEnd = event => {
          if (event.target !== element || event.animationName !== animationName) {
            return;
          }
          cleanup();
        };

        activeAnimationCleanups.add(cleanup);
        element.addEventListener('animationend', handleAnimationEnd);

        // If the token is already stale, resolve immediately.
        if (token !== backgroundTransitionToken) {
          cleanup();
        }
      });
    }

    const waitForFadeOut = (element, token) => waitForFacetimeAnimation(element, 'facetimeFadeOut', token);
    const waitForFadeIn = (element, token) => waitForFacetimeAnimation(element, 'facetimeFadeIn', token);
    const waitForIrisClose = (element, token) => waitForFacetimeAnimation(element, 'irisClose', token);
    const waitForIrisOpen = (element, token) => waitForFacetimeAnimation(element, 'irisOpen', token);

    function updateBackground(animationType = 'none') {
      backgroundTransitionToken += 1;
      resetFacetimeAnimation();
      const transitionToken = backgroundTransitionToken;

      const facetimeContent = document.querySelector('.facetime-content');
      const bgUrl = getCurrentBackgroundUrl();
      const backgroundPromise = ensureBackgroundPreload(bgUrl);

      const applyBackground = () => {
        if (!facetimeContent || transitionToken !== backgroundTransitionToken) return;

        if (bgUrl) {
          facetimeContent.style.setProperty('--bg-image', `url('${bgUrl}')`);
        } else {
          facetimeContent.style.removeProperty('--bg-image');
        }
      };

      // Check if user prefers reduced motion
      const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

      if (prefersReducedMotion || animationType === 'none') {
        return backgroundPromise.then(() => {
          if (transitionToken !== backgroundTransitionToken) return;
          applyBackground();
        });
      }

      if (animationType === 'iris') {
        if (!facetimeContent) return backgroundPromise;
        return (async () => {
          facetimeContent.classList.remove('fade-in', 'fade-out');
          facetimeContent.classList.add('iris-close');

          await Promise.all([
            backgroundPromise,
            waitForIrisClose(facetimeContent, transitionToken)
          ]);

          if (transitionToken !== backgroundTransitionToken) return;
          applyBackground();

          facetimeContent.classList.remove('iris-close');
          facetimeContent.classList.add('iris-open');

          await waitForIrisOpen(facetimeContent, transitionToken);

          if (transitionToken !== backgroundTransitionToken) return;
          facetimeContent.classList.remove('iris-open');
        })();
      }

      if (animationType === 'fade') {
        if (!facetimeContent) return backgroundPromise;
        return (async () => {
          facetimeContent.classList.remove('iris-close', 'iris-open', 'fade-in');
          facetimeContent.classList.add('fade-out');

          await Promise.all([
            backgroundPromise,
            waitForFadeOut(facetimeContent, transitionToken)
          ]);

          if (transitionToken !== backgroundTransitionToken) return;
          applyBackground();

          facetimeContent.classList.remove('fade-out');
          facetimeContent.classList.add('fade-in');

          await waitForFadeIn(facetimeContent, transitionToken);

          if (transitionToken !== backgroundTransitionToken) return;
          facetimeContent.classList.remove('fade-in');
        })();
      }

      backgroundPromise.then(() => {
        if (transitionToken !== backgroundTransitionToken) return;
        applyBackground();
      });
      return backgroundPromise;
    }

    // Initialize background on page load
    updateBackground();
    setupAvatarLoader();
    loadAppleProjects();
    applyGreeting();

    // Location switcher
    function switchLocation(location) {
      currentLocation = location;

      // Update active state on tiles
      document.querySelectorAll('.location-tile').forEach(tile => {
        tile.classList.remove('active');
      });
      document.querySelector(`[data-location="${location}"]`).classList.add('active');

      // Update background
      updateBackground();
    }

    // Theme toggle for FaceTime background
    (function () {
      const toggle = document.getElementById('themeToggle');
      toggle.addEventListener('click', function(e) {
        e.stopPropagation(); // Prevent triggering window click-to-front
        isDayMode = !isDayMode;

        // Update toggle state
        toggle.classList.toggle('active', isDayMode);

        applyGreeting({ animate: true });

        // Update background based on current location and theme
        updateBackground('fade');
      });
    })();

    // Avatar tap to rotate location (SF ‚Üí NYC ‚Üí non-US ‚Üí SF)
    (function () {
      const avatar = document.querySelector('.avatar');
      const sfLocation = document.getElementById('sfLocation');
      const nycLocation = document.getElementById('nycLocation');
      const nonusLocation = document.getElementById('nonusLocation');

      avatar.addEventListener('click', function(e) {
        e.stopPropagation(); // Prevent triggering window click-to-front

        // Rotate location: SF ‚Üí NYC ‚Üí non-US ‚Üí SF
        if (currentLocation === 'sf') {
          currentLocation = 'nyc';
        } else if (currentLocation === 'nyc') {
          currentLocation = 'nonus';
        } else {
          currentLocation = 'sf';
        }

        // Update footer: bold the active location
        sfLocation.style.fontWeight = currentLocation === 'sf' ? '700' : '300';
        nycLocation.style.fontWeight = currentLocation === 'nyc' ? '700' : '300';
        nonusLocation.style.fontWeight = currentLocation === 'nonus' ? '700' : '300';

        // Update background with animation
        hasUserChangedLocation = true;
        applyGreeting({ animate: false });
        updateBackground('iris');
      });
    })();

    // Dock project window interactions
    function openProjectWindow(windowId, options = {}) {
      const projectWindow = document.getElementById(windowId);
      // options.preserveIds allows specific window IDs to keep their active state (e.g., Finder remaining open)
      const preserveIds = options.preserveIds ?? [];
      const preserveSet = new Set(Array.isArray(preserveIds) ? preserveIds : [preserveIds].filter(Boolean));
      if (projectWindow) {
        document.querySelectorAll('.project-window').forEach(w => {
          if (w !== projectWindow && !preserveSet.has(w.id)) {
            w.classList.remove('active');
          }
        });

        projectWindow.classList.add('active');
        bringWindowToFront(projectWindow);

        if (window.matchMedia('(max-width: 768px)').matches) {
          requestAnimationFrame(() => {
            const rect = projectWindow.getBoundingClientRect();
            const viewportHeight = window.innerHeight || document.documentElement.clientHeight;
            const fullyVisible = rect.top >= 0 && rect.bottom <= viewportHeight;

            if (!fullyVisible) {
              projectWindow.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
          });
        }
      }
    }

    function closeProjectWindow(windowId) {
      const projectWindow = document.getElementById(windowId);
      if (projectWindow) {
        projectWindow.classList.remove('active');
      }
    }

    // Apple project window interactions
    function openAppleProject(projectWindowId) {
      const workWindow = document.getElementById('workWindow');
      if (workWindow) {
        workWindow.classList.add('active');
      }

      openProjectWindow(projectWindowId, { preserveIds: ['workWindow'] });
    }

    renderAppleProjects();

    // Make dock icons accessible for link elements
    document.querySelectorAll('.dock-icon').forEach(icon => {
      icon.addEventListener('click', function(e) {
        // Let links handle their own navigation
        if (this.tagName === 'A') {
          return;
        }
      });
    });

    // File Explorer folder toggle
    function toggleFolder(header) {
      const folder = header.parentElement;
      folder.classList.toggle('collapsed');

      // Update folder icon
      const icon = header.querySelector('.folder-icon');
      if (folder.classList.contains('collapsed')) {
        icon.src = 'assets/icon-folder.png'; // Closed folder icon
      } else {
        icon.src = 'assets/icon-folder.png'; // Open folder icon
      }
    }

  </script>
</body>
</html>
